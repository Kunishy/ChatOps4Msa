info:
  version: 1.0.0
  title: Message Delivery
  description: |
    Using RabbitMQ to receive message

low_code:
  on_message:
    - name: receive-rabbitmq-on_prometheus_alert
      parameter:
        event: null # message event
      description: |
        Trigger when receiving alerts from Prometheus
      access: private # users cannot execute actively
      body:
        - toolkit-json-parse: # parse the content of the event
            json: ${event}
            jsonpath: "$.data.alerts[*].labels.alertname"
        - toolkit-discord-embed: # send an embed component of Discord to the user
            title: Prometheus Alert
            color: red
            fieldJson: ${toolkit-json-parse}
            thumbnail: http://grafana.server/thumbnail.png